<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Posts</title>
</head>
<body>
    <h1>Post List</h1>

    <form method="GET" action="{% url 'search_post' %}">
        <input type="text" name="post_name" placeholder="Search for a post" required>
        <button type="submit">Search</button>
    </form>
    
    {% if posts %}
    <ul>
        {% for post in posts %}
            <li>
                <h2>{{ post.title }}</h2>
                <p>{{ post.body }}</p>
                <p><strong>Author:</strong> {{ post.author.username }}</p>
                <p><strong>Created At:</strong> {{ post.created_at }}</p>
                <p><strong>Last Updated At:</strong> {{ post.updated_at }}</p>
                <p><strong>Likes:</strong> {{ post.likes_count }}</p>
                <p><strong>Comments:</strong> {{ post.comments_count }}</p>
                <a href="{% url 'delete_edit_post' post.id %}">Delete</a>
                <a href="{% url 'delete_edit_post' post.id %}?edit=true">Edit</a>
                <a href="{% url 'like_post' post.id %}">Like</a>
                
                <!-- Comment Section -->
                <h3>Leave a Comment:</h3>
                <form method="POST" action="{% url 'comment_post' post.id %}">
                    {% csrf_token %}
                    <textarea name="body" placeholder="Write your comment here..." required></textarea>
                    <button type="submit">Comment</button>
                </form>
                
                <!-- Display Comments -->
                <h4>Comments:</h4>
                <ul>
                    {% for comment in post.comment_set.all %}
                        <li>
                            <strong>{{ comment.author.name }}:</strong> {{ comment.body }} 
                            <em>at {{ comment.created_at }}</em>
                        </li>
                    {% empty %}
                        <li>No comments yet.</li>
                    {% endfor %}
                </ul>
            </li>
        {% endfor %}
    </ul>
{% else %}
    <p>No posts available.</p>
{% endif %}


    
</body>
</html>
